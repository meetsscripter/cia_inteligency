<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <title>Relatório de Inteligência</title>
    <style>
        @keyframes flicker {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.6; } /* Ligeiramente mais suave */
        }

        @keyframes moveLine {
            from { transform: translateX(-100%); }
            to { transform: translateX(100%); }
        }

        @keyframes fadeOut {
            to { opacity: 0; visibility: hidden; }
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        body {
            margin: 0;
            padding: 30px; /* Reduzindo um pouco o padding geral */
            background-color: #0d1117;
            font-family: 'Fira Code', 'Courier New', Courier, monospace; /* Adicionando uma fonte moderna de fallback */
            color: #c9d1d9;
            line-height: 1.6; /* Melhora a legibilidade do texto */
        }

        h1 {
            text-align: center;
            font-size: 3.5em; /* Ajustando o tamanho da fonte */
            margin-bottom: 30px; /* Ajustando a margem inferior */
            color: #58a6ff;
            text-shadow: 0 0 10px #58a6ff; /* Ligeiramente mais intenso */
        }

        #formulario {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            padding: 20px;
            background-color: #0f1a25;
            border-radius: 8px;
            box-shadow: 0 0 15px rgba(88,166,255,0.3);
            align-items: center;
            justify-content: center;
        }

        #formulario input[type="text"] {
            padding: 12px;
            border: 1px solid #30363d;
            border-radius: 6px;
            background-color: #161b22;
            color: #c9d1d9;
            font-family: 'Fira Code', 'Courier New', Courier, monospace;
            font-size: 1em;
        }

        #formulario button {
            padding: 12px 20px;
            border: none;
            border-radius: 6px;
            background-color: #58a6ff;
            color: #0d1117;
            font-family: 'Fira Code', 'Courier New', Courier, monospace;
            font-size: 1em;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }

        #formulario button:hover {
            background-color: #3d8bf1;
        }

        #mensagem {
            text-align: center;
            margin-top: 15px;
            font-size: 1.1em;
            font-weight: bold;
        }

        #mensagem.liberado {
            color: #1fdf64;
        }

        #mensagem.negado {
            color: #ff7b72;
        }

        .resumo {
            background-color: #0f1a25;
            padding: 25px;
            border-radius: 10px;
            box-shadow: 0 0 20px rgba(88,166,255,0.4);
            text-align: center;
            margin-bottom: 40px;
            font-size: 1.3em; /* Ajustando o tamanho da fonte */
            animation: flicker 2s infinite;
        }

        .resumo span {
            display: block;
            font-size: 1em;
            margin: 10px 0;
        }

        .resumo .bonus {
            color: #1fdf64;
            font-weight: bold;
            font-size: 1.2em;
        }

        .dashboard {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); /* Ligeiramente menor para melhor adaptação */
            gap: 20px; /* Ajustando o espaçamento */
            margin-bottom: 40px;
        }

        .card {
            background-color: #0f1a25;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 0 18px rgba(88,166,255,0.3);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out; /* Adicionando transição para o hover */
        }

        .card:hover {
            transform: translateY(-5px); /* Leve efeito de elevação */
            box-shadow: 0 5px 24px rgba(88,166,255,0.5); /* Hover mais pronunciado */
        }

        .card h2 {
            font-size: 1.5em;
            color: #58a6ff;
            margin-bottom: 10px;
        }

        .card p {
            margin: 8px 0;
            font-size: 1em;
            text-align: center;
        }

        .scan-line {
            height: 3px; /* Ligeiramente mais fino */
            width: 100%;
            background: linear-gradient(to right, #58a6ff, transparent);
            animation: moveLine 2s linear infinite;
            margin-bottom: 25px; /* Ajustando a margem */
        }

        .loading-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background-color: #0d1117;
            color: #58a6ff;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            font-size: 1.8em;
            z-index: 9999;
            animation: fadeOut 1s ease forwards;
            animation-delay: 3s;
        }

        .loading-screen img {
            width: 100px; /* Ajustando o tamanho da imagem de loading */
            height: auto;
        }

        .loading-text {
            animation: flicker 2s infinite;
            margin-top: 15px;
            font-size: 0.9em;
        }

        .location-counts {
            background-color: #0f1a25;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 0 15px rgba(88,166,255,0.4);
            text-align: center;
            margin-bottom: 25px;
            font-size: 1em;
            animation: fadeIn 2s forwards 3s;
            opacity: 0;
        }

        .location-counts h2 {
            font-size: 1.2em;
            color: #58a6ff;
            margin-bottom: 8px;
        }

        .location-counts p {
            margin: 6px 0;
        }

        /* Media Queries para Responsividade */
        @media (max-width: 768px) {
            h1 {
                font-size: 2.5em;
                margin-bottom: 20px;
            }

            .resumo {
                font-size: 1.1em;
                padding: 20px;
                margin-bottom: 30px;
            }

            .dashboard {
                grid-template-columns: 1fr; /* Empilhando os cards em telas menores */
                gap: 15px;
                margin-bottom: 30px;
            }

            .card h2 {
                font-size: 1.3em;
            }

            .card p {
                font-size: 0.9em;
            }

            .location-counts {
                font-size: 0.9em;
                padding: 12px;
                margin-bottom: 20px;
            }
        }
    </style>
</head>
<body>

    <div id="formulario">
        <input type="text" id="codigo" placeholder="Digite o código">
        <button onclick="verificarCodigo()">Verificar</button>
        <div id="mensagem"></div>
      </div>

<div id="formContainer" style="display: none;">
    <div class="loading-screen" id="loading">
        <img src="https://i.gifer.com/ZKZg.gif" alt="Carregando..." width="120">
        <div class="loading-text">Carregando dados secretos...</div>
    </div>

    <h1 style="animation: fadeIn 2s forwards 3s; opacity: 0;">Relatório de Inteligência</h1>
    <div class="scan-line" style="animation: moveLine 2s linear infinite, fadeIn 2s forwards 3s; opacity: 0;"></div>
    <div id="resumo" class="resumo" style="animation: fadeIn 2s forwards 3s; opacity: 0;"></div>
    <div id="locationCounts" class="location-counts" style="display: none;">
        <h2>Mapeamentos realizados</h2>
        <p>Los Santos: <span id="losSantosCount">0</span></p>
        <p>Las Venturas: <span id="lasVenturasCount">0</span></p>
        <p>San Fierro: <span id="sanFierroCount">0</span></p>
        <p>Flinty County: <span id="flintyCountyCount">0</span></p>
        <p>Red County: <span id="redCountyCount">0</span></p>
        <p>Whetstone County: <span id="whetstoneCountyCount">0</span></p>
    </div>
    <div id="lista" class="dashboard" style="animation: fadeIn 2s forwards 3.5s; opacity: 0;"></div>
</div>


    <script>

let codigosLiberados = {};

// 🔻 Variáveis globais para armazenar os dados do usuário
let discord = '';       // Variável para armazenar o nome do usuário
let nomeCompleto = '';  // Variável para armazenar o nome completo

async function carregarCodigos() {
  try {
    const response = await fetch('codes.json');
    if (!response.ok) throw new Error("Erro ao carregar codes.json");
    codigosLiberados = await response.json();
  } catch (error) {
    console.error("Erro:", error);
  }
}

async function verificarCodigo() {
  const codigo = document.getElementById("codigo").value.trim();
  const mensagemDiv = document.getElementById("mensagem");
  const conteudo = document.getElementById("formContainer");
  const formulario = document.getElementById("formulario");
  const infoUsuario = document.getElementById("infoUsuario");
  const paginaAtual = window.location.pathname.split("/").pop();

  // Código usado pode ser local, pois é só para exibição
  const codigoUsado = codigo;

  const dados = codigosLiberados[codigo];

  if (!dados) {
    mensagemDiv.textContent = "Código inválido.";
    mensagemDiv.className = "negado";
    conteudo.style.display = "none";
  } else if (!dados.pages.includes(paginaAtual)) {
    mensagemDiv.textContent = `Acesso Negado para esta página `;
    mensagemDiv.className = "negado";
    conteudo.style.display = "none";
  } else {
    // ✅ Preenche as variáveis globais
    nomeCompleto = dados.nomeCompleto;
    discord = dados.discord;

    mensagemDiv.textContent = `Acesso Liberado!`;
    mensagemDiv.className = "liberado";
    formulario.style.display = "none";
    conteudo.style.display = "block";
  }

  document.getElementById("codigo").value = "";
}

carregarCodigos();

        // Impede o clique direito
        document.addEventListener("contextmenu", function(event) {
            event.preventDefault();
        });

        // Bloqueia atalhos de desenvolvedor
        document.addEventListener("keydown", function(event) {
            if (event.ctrlKey && (event.key === "u" || event.key === "s" || event.key === "i" || event.key === "j")) {
                event.preventDefault();
            }
            if (event.keyCode === 123) { // Bloqueia tecla F12
                event.preventDefault();
            }
        });

        // Detecta a abertura do DevTools e força um redirecionamento
        setInterval(function() {
            let before = new Date().getTime();
            debugger; // Caso o DevTools seja aberto, o tempo de execução muda
            let after = new Date().getTime();
            if (after - before > 100) {
                window.location.href = "about:blank"; // Fecha o site
            }
        }, 500);

        // Impede a seleção de texto, mas permite interações com campos de texto
        document.addEventListener("mousedown", function(event) {
            if (event.target.tagName !== "INPUT" && event.target.tagName !== "TEXTAREA") {
                event.preventDefault();
            }
        });


        const API_URL = "https://script.google.com/macros/s/AKfycbyEGgkE55FQpA1teX4LF95f0nddkOWbHHfW1rNPuduq2OYOn4pe29FgMo57SATepEfS/exec";

        function somarHoras(horas) {
            let totalSegundos = 0;
            horas.forEach(horaStr => {
                const [h, m, s] = horaStr.split(":").map(Number);
                totalSegundos += h * 3600 + m * 60 + s;
            });
            const h = Math.floor(totalSegundos / 3600);
            const m = Math.floor((totalSegundos % 3600) / 60);
            const s = totalSegundos % 60;
            return `${String(h).padStart(2, '0')}:${String(m).padStart(2, '0')}:${String(s).padStart(2, '0')}`;
        }

        fetch(API_URL)
            .then(res => res.json())
            .then(dados => {
                const lista = document.getElementById("lista");
                const resumo = document.getElementById("resumo");
                const locationCountsDiv = document.getElementById("locationCounts");
                const locationCounts = {
                    'Los Santos': 0,
                    'Las Venturas': 0,
                    'San Fierro': 0,
                    'Flinty County': 0,
                    'Red County': 0,
                    'Whetstone County': 0
                };
                const totais = {};

                let totalBonusGeral = 0;
                let totalHorasGeralSegundos = 0;
                let totalRegistrosGeral = 0;

                dados.forEach(item => {
                    const nome = item["RESPONSÁVEL"]?.trim() || "Desconhecido";
                    const bonus = parseFloat(item["BÔNUS"]) || 0;
                    const horasStr = item["HORAS"]?.trim() || "00:00:00";
                    const localizacao = item["CIDADE"]?.trim();

                    if (localizacao && locationCounts.hasOwnProperty(localizacao)) {
                        locationCounts[localizacao]++;
                    }

                    if (!totais[nome]) {
                        totais[nome] = { bonusTotal: 0, horas: [], quantidade: 0 };
                    }

                    totais[nome].bonusTotal += bonus;
                    totais[nome].horas.push(horasStr);
                    totais[nome].quantidade += 1;

                    totalBonusGeral += bonus;
                    const [h, m, s] = horasStr.split(":").map(Number);
                    totalHorasGeralSegundos += h * 3600 + m * 60 + s;
                    totalRegistrosGeral += 1;
                });

                // Atualiza a contagem de localizações no HTML
                document.getElementById("losSantosCount").textContent = locationCounts['Los Santos'];
                document.getElementById("lasVenturasCount").textContent = locationCounts['Las Venturas'];
                document.getElementById("sanFierroCount").textContent = locationCounts['San Fierro'];
                document.getElementById("flintyCountyCount").textContent = locationCounts['Flinty County'];
                document.getElementById("redCountyCount").textContent = locationCounts['Red County'];
                document.getElementById("whetstoneCountyCount").textContent = locationCounts['Whetstone County'];
                locationCountsDiv.style.display = 'block'; // Exibe a contagem de localizações

                const totalHorasFinal = `${String(Math.floor(totalHorasGeralSegundos / 3600)).padStart(2, '0')}:${String(Math.floor((totalHorasGeralSegundos % 3600) / 60)).padStart(2, '0')}:${String(totalHorasGeralSegundos % 60).padStart(2, '0')}`;

                resumo.innerHTML = `
                    <span class="bonus">Bônus: ${totalBonusGeral.toFixed(2)}</span>
                    <span>Horas: ${totalHorasFinal}</span>
                    <span>Registros: ${totalRegistrosGeral}</span>
                `;

                Object.entries(totais).forEach(([nome, info]) => {
                    const somaHoras = somarHoras(info.horas);
                    const div = document.createElement("div");
                    div.className = "card";
                    div.innerHTML = `
                        <h2>${nome}</h2>
                        <p><strong>Bônus Total:</strong> ${info.bonusTotal.toFixed(2)}</p>
                        <p><strong>Horas Totais:</strong> ${somaHoras}</p>
                        <p><strong>Registros:</strong> ${info.quantidade}</p>
                    `;
                    lista.appendChild(div);
                });

                // Esconde a tela de loading após os dados serem carregados
                document.getElementById("loading").style.display = "none";
            })
            .catch(error => {
                console.error("Erro ao carregar dados:", error);
            });
    </script>
</body>
</html>
